---
title: "Midterm Part 1: Neighborhood Change in San Antonio"
author: |
  | **Your name here**
  | URP 5393 - Urban Planning Methods II
  | The University of Texas at San Antonio
date: "3/8/2022"
output: 
  html_document:
    code_folding: hide
---

##### 1. Introduction

San Antonio is one of the fastest growing cities in Texas. Between 2015 and 2020 the SA metro area added 300,000 new residents reaching a total of 2.6 million, and is expected to gain an additional 1 million residents by 2035 and  another million by 2050 reaching a total of 4.4 million residents[^1]. With population growth, an increased demand for land is expected which will in turn create neighborhood change pressures in more desirable locations throughout the SA metro area. *[context]*

##### 1.1 Conceptual framework

Population growth --(+)--> Housing Demand --(+)--> Housing Prices --(+)--> Neighborhood Change

Assessing neighborhood change is key identify sings of potential gentrification and displacement and ultimately the loss of cultural value in urban communities. This research main question is:

*   Is there disproportionate home value growth across neighborhoods that that can suggest neighborhood change processes are taking place in the city of San Antonio? *[research question 1]*

##### 1.2 Hypotheses

This empirical exercise will test and operationalize the following hypothesis:

-   $H0_1:$ There is no disproportionate growth in home values across census tracks in Bexar county between 2014-2019.

##### 1.3 Data & Variables of interest (operationalization)

This research will use American Community Survey (ACS) data from the United States Census Bureau gathered using the `tidycensus` R Package. A census tract will be categorized as having disproportionate growth if it's growth value is over the county median value.Each of the hypotheses previously stated will be operationalized as:

-   $H0_1:$ Census tract level data will be used for the years 2015 and 2019 using the `B25077_001` variable (Median Home Value in Dollars).

```{r tidycensus_setup, echo=FALSE, message=FALSE, warning=FALSE}
library(tidycensus)

census_api_key("0d539976d5203a96fa55bbf4421110d4b3db3648")# you must acquired your own key at http://api.census.gov/data/key_signup.html

# variable dictionary
# for detailed definitions visit: https://www2.census.gov/programs-surveys/acs/tech_docs/subject_definitions/2019_ACSSubjectDefinitions.pdf

acs_vars<-load_variables(year = 2019,dataset = "acs5")
acs_vars_subject<-load_variables(year = 2019,dataset = "acs5/subject")
acs_vars_profile<-load_variables(year = 2019,dataset = "acs5/profile")

```

```{r raw data, message=FALSE, warning=FALSE, results='hide'}
#downloading data using ACS API
bexar_homevalue_14 <- get_acs(geography = "tract", variables = "B25077_001",
                           state = "TX", county = "Bexar", geometry = TRUE,year = 2014)
bexar_homevalue_19 <- get_acs(geography = "tract", variables = "B25077_001",
                           state = "TX", county = "Bexar", geometry = FALSE,year = 2019)

```

##### 1.4 Calculating disproportionate home value value growth

Disproportionate home value growth is calculated as:

$$
  Disp_{c,t_f-t_i} =(\frac{value_{c,t_f}}{value_{c,t_i}})-1
$$
where for any census tract $c$, percent change values are calculated using the final year $t_f$ and the initial year $t_i$ values of the same variable ($value$)

```{r merging data, warning=FALSE, message=FALSE}
#Fixing variable names 
names(bexar_homevalue_14)[names(bexar_homevalue_14)%in%c("estimate","moe")] <-c("estimate_mhv_14","moe_mhv_14")
names(bexar_homevalue_19)[names(bexar_homevalue_19)%in%c("estimate","moe")] <-c("estimate_mhv_19","moe_mhv_19")

#Merging data
bexar_mhv<-merge(bexar_homevalue_14,bexar_homevalue_19,by="GEOID",sort = F)
  
#Calculating the percentage change
bexar_mhv$mhv_per_change<-round(((bexar_mhv$estimate_mhv_19/bexar_mhv$estimate_mhv_14)-1),2)

```

Descriptive Statistic Table for Median Home Values (mhv) in Bexar County
```{r descriptive statistics}
`mhv 2014`<-summary(bexar_mhv$estimate_mhv_14) # 2014 summary statistics
`mhv 2019`<-summary(bexar_mhv$estimate_mhv_19) # 2019 summary statistics
`Per. Change` <-summary(bexar_mhv$mhv_per_change)

rbind(`mhv 2014`,`mhv 2019`,`Per. Change`)
```

##### 1.6 Visualizing Data: Choropleth map

```{r plot_1, warning=FALSE, message=FALSE}
library(leaflet)
library(classInt)

#defining color palette
bbins_mhv<-classIntervals(var = bexar_mhv$mhv_per_change,n = 5,style = "jenks")
pal_mhv <- colorBin("YlOrRd", domain = bexar_mhv$mhv_per_change, bins = bbins_mhv$brks)

leaflet()%>%
  addProviderTiles(provider = providers$CartoDB.Positron)%>%
  addPolygons(fillColor = pal_mhv(bexar_mhv$mhv_per_change),color="white",weight = 0.5,fillOpacity = 0.7,data=bexar_mhv,group = "PC MHV")%>%
  addLegend(pal = pal_mhv, values = bexar_mhv$mhv_per_change, opacity = 0.7, title = NULL, position = "bottomright") %>%
  addLayersControl(overlayGroups = c("PC MHV"))

```


##### 1.7 Visualizing Data: Boxplot

##### 1.8 Statistical Analysis: 
##### 1.9 Statistical Analysis: 
##### 1.10 Statistical Analysis: 
##### 1.11 Statistical Analysis: 
##### 1.12 Statistical Analysis: Scatter Plot


#### References

[^1]:  2050 demographic projections. Alamo Area Metropolitan Planning Organization https://aampo-mobility-2050-atginc.hub.arcgis.com